(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    161021,       4580]
NotebookOptionsPosition[    144494,       4293]
NotebookOutlinePosition[    144889,       4309]
CellTagsIndexPosition[    144846,       4306]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Define Vector Basis", "Subsubsection",
 CellChangeTimes->{{3.8943618054833508`*^9, 3.894361807340372*^9}, {
  3.8943618450889673`*^9, 
  3.8943618460972767`*^9}},ExpressionUUID->"a7d4dc25-381c-4aa8-8239-\
3ccb919caa2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hatk", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", " ", 
  RowBox[{"kvec", " ", "=", " ", 
   RowBox[{"k", "*", "hatk"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hatq", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"\[Mu]", "^", "2"}]}], "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"\[Mu]", "^", "2"}]}], "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "\[Mu]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaK", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.894361814057653*^9, 3.894361831907674*^9}, 
   3.894367455509206*^9, {3.894371921884049*^9, 3.894371922757874*^9}, {
   3.894371978784972*^9, 3.894371979670542*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c136babb-20c5-4a38-b695-87a261ca5393"]
}, Open  ]],

Cell[CellGroupData[{

Cell["P1 Basis", "Section",
 CellChangeTimes->{{3.89436747197188*^9, 
  3.894367477959483*^9}},ExpressionUUID->"607a69c2-8a9e-49ca-a536-\
3cce894d4932"],

Cell[CellGroupData[{

Cell["Generate Tensor Basis", "Subsubsection",
 CellChangeTimes->{{3.894361833774434*^9, 3.894361843447666*^9}, {
  3.894367439028159*^9, 
  3.8943674535627527`*^9}},ExpressionUUID->"22cf7621-163e-46ee-a17b-\
b62c0598c93c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1", " ", "=", " ", 
   RowBox[{
   "hatk", "\[TensorProduct]", "deltaK", "\[TensorProduct]", "deltaK"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E1", "]"}]}], "Input",
 CellChangeTimes->{{3.8943618500357113`*^9, 3.8943618805976343`*^9}, {
   3.8943622987322893`*^9, 3.8943623300650187`*^9}, {3.894362483687097*^9, 
   3.894362499156934*^9}, 3.8943628193142757`*^9, {3.894363061467105*^9, 
   3.89436306230051*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e98553f6-ef10-4616-b75a-0295b0514859"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8943624997032957`*^9, 3.8943628199067583`*^9, 
  3.894363063120429*^9, 3.89436930138041*^9, 3.894369463947075*^9, 
  3.894371073460421*^9, 3.894371930607293*^9, 3.894371984518251*^9, 
  3.894372221159984*^9, 3.894372554812173*^9, 3.894380597568479*^9},
 CellLabel->
  "Out[2021]=",ExpressionUUID->"9c6db09f-5dad-4b19-8b86-594963d7ec84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E2", " ", "=", " ", 
   RowBox[{"hatk", "\[TensorProduct]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "l"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E2", "]"}]}], "Input",
 CellChangeTimes->{{3.894361882045842*^9, 3.8943619136212873`*^9}, {
   3.894362116105892*^9, 3.8943621670596313`*^9}, {3.894362216772059*^9, 
   3.894362249546924*^9}, {3.894362338759591*^9, 3.894362348710864*^9}, 
   3.894362407894953*^9, {3.8943624562071857`*^9, 3.8943624815070457`*^9}, 
   3.894362807785542*^9, {3.894363066362694*^9, 3.894363066778392*^9}, {
   3.8943725505098886`*^9, 3.89437255093288*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"274ea203-ff6b-4ba5-af94-caf4f4668f00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894362481833087*^9, 3.8943625011393127`*^9}, 
   3.894362808708968*^9, 3.8943630671035137`*^9, 3.894369301394163*^9, 
   3.894369463960919*^9, 3.894371073474671*^9, 3.894371930619685*^9, 
   3.8943719845305033`*^9, 3.894372221174469*^9, 3.894372554824819*^9, 
   3.894380597603428*^9},
 CellLabel->
  "Out[2024]=",ExpressionUUID->"55775697-4af1-40e4-a921-4cdba19d796e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hatk", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "b"}], "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E3", "]"}]}], "Input",
 CellChangeTimes->{{3.894362442249929*^9, 3.894362448078806*^9}, {
  3.894362507449637*^9, 3.894362760260476*^9}, {3.894362800249898*^9, 
  3.894362812758575*^9}, {3.894363070312348*^9, 3.894363070607553*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0b9a260f-e1cb-4f3c-9798-f9d13a231e47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894362688845414*^9, 3.894362761773837*^9}, {
   3.8943628058357058`*^9, 3.89436281327525*^9}, 3.894363070997901*^9, 
   3.894369301426708*^9, 3.894369463990552*^9, 3.894371073505763*^9, 
   3.894371930645961*^9, 3.8943719845553493`*^9, 3.894372221201195*^9, 
   3.894372554867137*^9, 3.894380597640977*^9},
 CellLabel->
  "Out[2028]=",ExpressionUUID->"9bf22a95-f4bf-498b-a22e-467cb8b951e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hatk", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "c"}], "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"b", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E4", "]"}]}], "Input",
 CellChangeTimes->{{3.894362835743816*^9, 3.894362963429187*^9}, {
  3.894363078194256*^9, 3.894363080961378*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a32569f9-c3c8-41d4-9cfa-0bd9900f24ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.894362963825506*^9, {3.894363078982925*^9, 3.894363081821402*^9}, 
   3.894369301460051*^9, 3.894369464022876*^9, 3.894371073536685*^9, 
   3.89437193067426*^9, 3.894371984581723*^9, 3.8943722212403927`*^9, 
   3.894372554898221*^9, 3.894380597676551*^9},
 CellLabel->
  "Out[2033]=",ExpressionUUID->"20be50c2-eb12-48f6-9e68-1ca8fa7f08a3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8943622530695467`*^9, 3.8943622936228952`*^9}, {
  3.894362599629867*^9, 3.894362620879458*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"4b43a6a3-b0e2-427c-8cc1-639dbb8b1e86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compute Trace as sum A*k_i delta_{cd} + B*(k_c delta_id + k_d delta_ic)\
\>", "Subsection",
 CellChangeTimes->{{3.894363018616173*^9, 
  3.894363056047683*^9}},ExpressionUUID->"062d403c-83df-4b9a-8c0c-\
c1f3175496ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr1", " ", "=", 
   RowBox[{"hatk", "\[TensorProduct]", "deltaK"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tr2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"hatk", "[", 
        RowBox[{"[", "c", "]"}], "]"}], "*", 
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "d"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hatk", "[", 
        RowBox[{"[", "d", "]"}], "]"}], "*", 
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "c"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894363088588385*^9, 3.8943631924661007`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9ebf9c3b-dcce-4cb6-beb5-fc44d9c61292"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrE1", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "*", "Tr1"}], "+", 
      RowBox[{"B", "*", "Tr2"}]}], "==", 
     RowBox[{"TensorContract", "[", 
      RowBox[{"E1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894363196416583*^9, 3.894363218153397*^9}, {
  3.89436332598492*^9, 3.894363356442746*^9}, {3.894364001570202*^9, 
  3.894364001700739*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"de24611d-f290-414e-96a8-aa0755e7dfe8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[Rule]", "3"}], ",", 
    RowBox[{"B", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.894363218527935*^9, {3.894363343867877*^9, 3.894363356829866*^9}, 
   3.8943640020809*^9, 3.894369301501061*^9, 3.894369464061298*^9, 
   3.894371073577999*^9, 3.894371930719432*^9, 3.894371984615555*^9, 
   3.8943722212760687`*^9, 3.894372554931205*^9, 3.894380597721045*^9},
 CellLabel->
  "Out[2037]=",ExpressionUUID->"f4251bc6-3f92-445b-994d-b7c5fef75d7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrE2", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "*", "Tr1"}], "+", 
      RowBox[{"B", "*", "Tr2"}]}], "==", 
     RowBox[{"TensorContract", "[", 
      RowBox[{"E2", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8943632328154297`*^9, 3.8943632358101254`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"900377fd-2098-4e7a-8285-66c676b829ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[Rule]", "1"}], ",", 
    RowBox[{"B", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8943632361566877`*^9, 3.894364003466735*^9, 
  3.894369301532517*^9, 3.8943694640892677`*^9, 3.894371073608287*^9, 
  3.894371930746312*^9, 3.8943719846376543`*^9, 3.894372221301805*^9, 
  3.894372554954329*^9, 3.894380597753215*^9},
 CellLabel->
  "Out[2038]=",ExpressionUUID->"fd78399c-0a20-4b80-a673-7d78508507ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrE3", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "*", "Tr1"}], "+", 
      RowBox[{"B", "*", "Tr2"}]}], "==", 
     RowBox[{"TensorContract", "[", 
      RowBox[{"E3", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894363240750381*^9, 3.894363240845237*^9}, {
  3.894364192391492*^9, 3.8943641925085573`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"1ec4b974-ee86-437b-9a8c-1cbe26fbacd8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[Rule]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"B", "\[Rule]", 
     FractionBox["3", "4"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.89436324116063*^9, 3.894364005028151*^9, 
  3.8943641929874477`*^9, 3.894369301545685*^9, 3.894369464102195*^9, 
  3.8943710736239853`*^9, 3.894371930760014*^9, 3.894371984651341*^9, 
  3.894372221316463*^9, 3.8943725549662313`*^9, 3.894380597771866*^9},
 CellLabel->
  "Out[2039]=",ExpressionUUID->"06d69622-7665-49e2-97f7-8879433430e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrE4", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "*", "Tr1"}], "+", 
      RowBox[{"B", "*", "Tr2"}]}], "==", 
     RowBox[{"TensorContract", "[", 
      RowBox[{"E4", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8943632466913557`*^9, 3.894363246843849*^9}, {
  3.89436419541191*^9, 3.894364195523734*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d650a51f-6b9f-4235-8bb6-6ebc66a5b6c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[Rule]", "0"}], ",", 
    RowBox[{"B", "\[Rule]", 
     FractionBox["1", "2"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.894363247343552*^9, 3.894364006175476*^9, 
  3.894364195906068*^9, 3.894369301575921*^9, 3.894369464129931*^9, 
  3.8943710736542797`*^9, 3.894371930782833*^9, 3.894371984673587*^9, 
  3.894372221341179*^9, 3.894372554989093*^9, 3.894380597804553*^9},
 CellLabel->
  "Out[2040]=",ExpressionUUID->"db867356-f520-4d6a-8e5c-3d843f4c1846"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"A1", "*", 
      RowBox[{"TensorContract", "[", 
       RowBox[{"E1", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"A2", "*", 
      RowBox[{"TensorContract", "[", 
       RowBox[{"E2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"A3", "*", 
      RowBox[{"TensorContract", "[", 
       RowBox[{"E3", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"A4", "*", 
      RowBox[{"TensorContract", "[", 
       RowBox[{"E4", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], "==", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"A1", ",", "A2", ",", "A3", ",", "A4"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.894363992029455*^9, 3.894364045792075*^9}, {
  3.894364096971613*^9, 3.89436410555055*^9}, {3.89436414015361*^9, 
  3.8943641547966623`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"54fe56e7-c10c-4501-8564-75acd2996835"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    2041, 201, 29919502625066334502, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8943640288957033`*^9, 3.8943641070095778`*^9, 
  3.894364155199238*^9, 3.894364197074087*^9, 3.894369301602088*^9, 
  3.894369464143404*^9, 3.894371073670772*^9, 3.894371930807316*^9, 
  3.894371984685932*^9, 3.8943722213568153`*^9, 3.894372555001419*^9, 
  3.8943805978250723`*^9},
 CellLabel->
  "During evaluation of \
In[2041]:=",ExpressionUUID->"81b0b2e0-941a-460a-b09a-df387b8159d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A3", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "6"}], " ", "A1"}], "-", 
      RowBox[{"2", " ", "A2"}]}]}], ",", 
    RowBox[{"A4", "\[Rule]", 
     RowBox[{
      RowBox[{"9", " ", "A1"}], "+", 
      RowBox[{"3", " ", "A2"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.894364028942644*^9, 3.894364107050383*^9, 
  3.8943641552083187`*^9, 3.8943641970822363`*^9, 3.894369301611709*^9, 
  3.894369464153709*^9, 3.894371073684677*^9, 3.8943719308181677`*^9, 
  3.8943719846946783`*^9, 3.894372221370165*^9, 3.894372555012476*^9, 
  3.8943805978441553`*^9},
 CellLabel->
  "Out[2041]=",ExpressionUUID->"6e1b43b3-970b-4544-bb47-4f845759b439"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solsp1", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A1", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E1", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"A2", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"A3", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E3", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"A4", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E4", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], "==", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"A2", ",", "A4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.89436434126429*^9, 3.894364344266658*^9}, {
  3.894364474533296*^9, 3.8943644751033382`*^9}, {3.894372181787882*^9, 
  3.8943721841569443`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"290ef329-d359-4999-b70d-5783b2c8d2b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A2", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "6"}], " ", "A1"}], "-", "A3"}], ")"}]}]}], ",", 
    RowBox[{"A4", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "A3"}], "2"]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.894364344706559*^9, 3.894364475990676*^9, 
  3.894369301642172*^9, 3.894369464180237*^9, 3.894371073712932*^9, 
  3.8943719308415318`*^9, 3.89437198471698*^9, 3.894372221394065*^9, 
  3.894372555035067*^9, 3.894380597874298*^9},
 CellLabel->
  "Out[2042]=",ExpressionUUID->"76774e60-c17c-4261-b56c-bf8b58192f16"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form Basis", "Subsection",
 CellChangeTimes->{{3.894364462109634*^9, 
  3.894364483217211*^9}},ExpressionUUID->"6e708792-b0f2-4887-9b03-\
64172e40e7a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q1A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A1", "*", "E1"}], "+", 
        RowBox[{"A2", "*", "E2"}], "+", 
        RowBox[{"A3", "*", "E3"}], "+", 
        RowBox[{"A4", "*", "E4"}]}], ")"}], "/.", 
      RowBox[{"solsp1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "1"}], ",", 
      RowBox[{"A3", "->", "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q1B", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A1", "*", "E1"}], "+", 
        RowBox[{"A2", "*", "E2"}], "+", 
        RowBox[{"A3", "*", "E3"}], "+", 
        RowBox[{"A4", "*", "E4"}]}], ")"}], "/.", 
      RowBox[{"solsp1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "0"}], ",", 
      RowBox[{"A3", "->", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894364485708267*^9, 3.894364538622735*^9}, {
  3.894364574787657*^9, 3.894364575499351*^9}, {3.894364718682025*^9, 
  3.894364740796955*^9}, {3.894369424589559*^9, 3.8943694293441896`*^9}, {
  3.894372186912157*^9, 3.894372188572081*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"24a63eeb-389d-4342-8be9-7e8c0fbab9d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm1A", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q1A", "\[TensorProduct]", "Q1A"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm1B", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q1B", "\[TensorProduct]", "Q1B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1dotB1", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q1A", "\[TensorProduct]", "Q1B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.894364541043154*^9, 3.894364546275354*^9}, {
  3.894364743528062*^9, 3.894364851786551*^9}, {3.8943694324056063`*^9, 
  3.8943694585366983`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"c2d26f73-faba-4e96-ad38-ee51e19fdfd8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894364567505484*^9, 3.894364571745119*^9}, {
  3.8943647024973783`*^9, 3.894364715521096*^9}, {3.894364862103176*^9, 
  3.894364890379059*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"f9cdcf4a-5b37-440e-9ed2-aa6482951406"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894364934111266*^9, 3.894364951488522*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"a4340ddd-eff8-4e18-bc3e-9d6a3cdc3b0d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P3 Basis", "Section",
 CellChangeTimes->{{3.894367488626202*^9, 
  3.894367495546835*^9}},ExpressionUUID->"cf76b427-a545-490c-a461-\
c582ccb31c02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Legendre3kvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", "*", 
       RowBox[{
       "hatk", "\[TensorProduct]", "hatk", "\[TensorProduct]", "hatk"}]}], 
      "-", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "*", 
          RowBox[{"hatk", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], " ", "+", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"j", ",", "k"}], "]"}], "*", 
          RowBox[{"hatk", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"k", ",", "i"}], "]"}], "*", 
          RowBox[{"hatk", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], "  ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.894367552029729*^9, 3.894367573135841*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d2b5f316-3db3-4880-b227-d2aea47de6b6"],

Cell[CellGroupData[{

Cell["Generate Tensor Basis", "Subsection",
 CellChangeTimes->{{3.8943675889703283`*^9, 
  3.894367600175775*^9}},ExpressionUUID->"1b907591-ea97-4458-9b25-\
b4eed346d9b2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"a", ",", "b"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3kvec", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E1", "]"}]}], "Input",
 CellChangeTimes->{{3.894367630548313*^9, 3.894367723191292*^9}, {
  3.894367809361079*^9, 3.894367812621285*^9}, {3.894368530241671*^9, 
  3.894368531487979*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"3df78be4-5cfa-4f09-95d5-e2200e9962ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8943678133327017`*^9, 3.894368533975552*^9, 
  3.894368581733889*^9, 3.894369301790821*^9, 3.894369464325076*^9, 
  3.8943710738497267`*^9, 3.894371931015026*^9, 3.89437198485703*^9, 
  3.8943722215348454`*^9, 3.894372555165501*^9, 3.894380598035087*^9},
 CellLabel->
  "Out[2053]=",ExpressionUUID->"e5402b11-e619-43b6-b790-0d6228cfa236"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "a"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3kvec", "[", 
       RowBox[{"[", 
        RowBox[{"b", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E2", "]"}]}], "Input",
 CellChangeTimes->{{3.89436774102514*^9, 3.8943677582214127`*^9}, {
  3.894367829052208*^9, 3.894367889211183*^9}, {3.894368133198504*^9, 
  3.894368139099556*^9}, {3.894368536016925*^9, 3.894368537882945*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"714cf7cb-0aa0-4cff-9272-94478ed4bcfa"],

Cell[BoxData[
 RowBox[{"Symmetric", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.894368180164811*^9, 3.8943683263674726`*^9, 
  3.894368539486864*^9, 3.894369301818392*^9, 3.894369464350709*^9, 
  3.894371073880322*^9, 3.894371931073103*^9, 3.89437198488216*^9, 
  3.894372221564515*^9, 3.894372555190796*^9, 3.8943805980688143`*^9},
 CellLabel->
  "Out[2057]=",ExpressionUUID->"9d67fc86-36c9-43a8-908e-cdf8455cfbe1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"a", ",", "c"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3kvec", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "b", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E3", "]"}]}], "Input",
 CellChangeTimes->{{3.894368194597445*^9, 3.8943682086086597`*^9}, {
  3.8943682916518593`*^9, 3.894368318678885*^9}, {3.894368541282106*^9, 
  3.894368546799258*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"03d46ef1-701c-429f-b13d-fb91f9f5f2e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894368297703614*^9, 3.894368319326886*^9}, {
   3.8943685437699614`*^9, 3.894368547469776*^9}, 3.894369301846115*^9, 
   3.894369464377223*^9, 3.894371073910809*^9, 3.894371931155753*^9, 
   3.894371984906177*^9, 3.894372221594542*^9, 3.8943725552141037`*^9, 
   3.89438059810109*^9},
 CellLabel->
  "Out[2062]=",ExpressionUUID->"7ae463fb-ce66-45b3-9b70-a7fc62352fda"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894368414379746*^9, 3.894368450026244*^9}, {
  3.8943685238901*^9, 3.8943685249782867`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"904857ac-8b99-4242-adbb-3eec2dfb16f3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894368328104404*^9, 3.89436834298425*^9}, {
  3.894368562349195*^9, 3.894368596898797*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"9b1d7ceb-e8d4-451c-8983-b47f0820c739"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Trace: Now it will be proportional to Picd", "Subsection",
 CellChangeTimes->{{3.89436870306085*^9, 
  3.89436871984062*^9}},ExpressionUUID->"48bb1f97-1437-478a-a9e0-\
60a3ad5a33fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solsp3", " ", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A1", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E1", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"A2", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"A3", "*", 
       RowBox[{"TensorContract", "[", 
        RowBox[{"E3", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], "==", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", "A3", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894368735165844*^9, 3.8943687973111477`*^9}, {
  3.8943688366955*^9, 3.894368858168158*^9}, {3.894372203256481*^9, 
  3.894372203460455*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"35700b3e-0f16-49e3-baaf-a7fbdb2c990f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"A3", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "A1"}], "-", "A2"}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.894368754818644*^9, {3.894368785143619*^9, 3.894368797658004*^9}, {
   3.89436883838308*^9, 3.894368858916854*^9}, 3.894369301880999*^9, 
   3.8943694644112883`*^9, 3.894371073950053*^9, 3.894371931308876*^9, 
   3.89437198494028*^9, 3.894372221633182*^9, 3.894372555246974*^9, 
   3.8943805981421967`*^9},
 CellLabel->
  "Out[2065]=",ExpressionUUID->"824bc9c1-70d5-414d-a714-d628caf41682"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q3A", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A1", "*", "E1"}], "+", 
        RowBox[{"A2", "*", "E2"}], "+", 
        RowBox[{"A3", "*", "E3"}]}], ")"}], "/.", 
      RowBox[{"solsp3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "1"}], ",", 
      RowBox[{"A2", "->", "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3B", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A1", "*", "E1"}], "+", 
        RowBox[{"A2", "*", "E2"}], "+", 
        RowBox[{"A3", "*", "E3"}]}], ")"}], "/.", 
      RowBox[{"solsp3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "0"}], ",", 
      RowBox[{"A2", "->", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894368994857067*^9, 3.894369026958706*^9}, {
  3.894372199708757*^9, 3.894372201649897*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"a146d3ab-de7c-416d-8ecc-2da22a98c2cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm3A", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3A", "\[TensorProduct]", "Q3A"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm3B", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3B", "\[TensorProduct]", "Q3B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A3dotB3", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3A", "\[TensorProduct]", "Q3B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.894369045090055*^9, 3.894369081990041*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"421cb480-adb0-481d-a570-9b2f8f0f064b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigensystem", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"norm3A", ",", "A3dotB3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"A3dotB3", ",", "norm3B"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.894369100619844*^9, 3.894369123502448*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"33cfa2ca-acce-4899-af7e-06a7d47c1b23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["15", "4"], ",", 
     FractionBox["45", "16"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.89437222177404*^9, 3.894372555372061*^9, 
  3.894380598279643*^9},
 CellLabel->
  "Out[2071]=",ExpressionUUID->"4d7426a5-987e-470e-98ea-8248ec8b1f1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["15", "4"], ",", 
     FractionBox["45", "16"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{3.8943721167634583`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"d890ae3b-e61c-4a88-88e9-587d602c19d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["15", "4"], ",", 
     FractionBox["45", "16"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.894372116848146*^9, 3.894372221799658*^9, 
  3.894372555394505*^9, 3.894380598311899*^9},
 CellLabel->
  "Out[2072]=",ExpressionUUID->"4984c5fc-a8f8-49e4-8589-e9ccd49b90a8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q3Anew", "=", 
   RowBox[{"Q3A", "+", "Q3B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3Bnew", " ", "=", " ", 
   RowBox[{"Q3A", "-", "Q3B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3A", " ", "=", " ", "Q3Anew"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3B", "=", "  ", "Q3Bnew"}], ";"}]}], "Input",
 CellChangeTimes->{{3.894369147799514*^9, 3.894369254887151*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"a80c7cd8-e383-4d68-b088-e9eb6ec03701"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm3A", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3A", "\[TensorProduct]", "Q3A"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm3B", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3B", "\[TensorProduct]", "Q3B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A3dotB3", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Q3A", "\[TensorProduct]", "Q3B"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellLabel->"In[61]:=",ExpressionUUID->"4fb1c3cb-6ed4-4e15-93b6-1894183883e6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894369263250235*^9, 3.894369272801207*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"072e79f6-1852-41ce-9625-e4b009a5bd9f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P5 Basis", "Section",
 CellChangeTimes->{{3.894369363471979*^9, 
  3.894369367131895*^9}},ExpressionUUID->"6b0c93ba-2b0f-477b-aa80-\
1fd674efe82d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Legendre5kvec5", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "8"}], " ", "*", " ", "63", " ", "*", " ", 
    RowBox[{
    "hatk", "\[TensorProduct]", "hatk", "\[TensorProduct]", "hatk", 
     "\[TensorProduct]", "hatk", "\[TensorProduct]", "hatk"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5kvec3", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", "1"}], "/", "8"}], "*", "7", "*", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symdeltadelta", " ", "=", " ", 
   RowBox[{"3", "*", 
    RowBox[{"Normal", "[", 
     RowBox[{"Symmetrize", "[", 
      RowBox[{
       RowBox[{"deltaK", "\[TensorProduct]", "deltaK"}], ",", 
       RowBox[{"Symmetric", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5kvec1", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "8"}], "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"hatk", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatk", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatk", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatk", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "i", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatk", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "l", ",", "i"}], "]"}], "]"}]}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5kvec", "=", 
   RowBox[{"Legendre5kvec1", "+", "Legendre5kvec3", "+", "Legendre5kvec5"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normP5", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"Legendre5kvec", "\[TensorProduct]", "Legendre5kvec"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.894369379287842*^9, 3.894369396608268*^9}, {
  3.894372090767974*^9, 3.894372101053504*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"0cd328d6-2a5b-4fb5-8871-a910b501e073"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894369410568412*^9, 3.894369413417656*^9}, {
  3.89436946836376*^9, 3.894369477127583*^9}, {3.8943804003328114`*^9, 
  3.894380404117816*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"b7d8cf62-6f0c-4a51-af3a-f54cd08f2b57"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Project <Psi2 s_ab | s_cd>", "Section",
 CellChangeTimes->{{3.894369493714901*^9, 
  3.8943695090786667`*^9}},ExpressionUUID->"9610fc8b-958c-4608-a8f0-\
18cffbd8896c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TFkvecdelta", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"j", ",", "k"}], "]"}], "*", 
       RowBox[{"hatk", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], " ", "-", 
      RowBox[{
       RowBox[{"3", "/", "2"}], "*", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "*", 
          RowBox[{"hatk", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], " ", "+", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"k", ",", "i"}], "]"}], "*", 
          RowBox[{"hatk", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], "  ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894369795345564*^9, 3.894369804471614*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"309c108a-cb06-4f4e-97d7-10cb91f8a652"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FTCorrelator", " ", "=", 
   RowBox[{
    RowBox[{"Rs3", "*", "Legendre3kvec"}], "+", 
    RowBox[{"Rs1", "*", "TFkvecdelta"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTCorrelator", " ", "=", " ", 
   RowBox[{"I", "*", 
    RowBox[{"FTCorrelator", " ", "\[TensorProduct]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hatk", "\[TensorProduct]", "hatk"}], "-", 
       RowBox[{
        RowBox[{"1", "/", "3"}], "*", "deltaK"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTCorrelator", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Normal", "[", 
     RowBox[{"Symmetrize", "[", 
      RowBox[{"FTCorrelator", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cycles", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
        "}"}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "FTCorrelator", "]"}]}], "Input",
 CellChangeTimes->{{3.894369687275228*^9, 3.89436970714954*^9}, {
  3.894369764049685*^9, 3.8943698375235977`*^9}, {3.894369873075452*^9, 
  3.894369878035833*^9}, {3.894370859634239*^9, 3.894370910825336*^9}, {
  3.89438040921672*^9, 3.894380409666638*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"a8e2501e-1a87-4a3c-8fcf-66a9b0b4d435"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894370901517582*^9, 3.894370911106666*^9}, 
   3.894371038246832*^9, 3.8943710742847443`*^9, {3.894371962709428*^9, 
   3.894371985252288*^9}, 3.894372221986133*^9, 3.8943725555720654`*^9, 
   3.894380598507279*^9},
 CellLabel->
  "Out[2092]=",ExpressionUUID->"1677a019-96d6-48a1-a3ca-16f0f0a07d4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols5", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A5coeff", " ", "->", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"FTCorrelator", "\[TensorProduct]", "Legendre5kvec"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "7"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "9"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "/", 
        "normP5"}], "]"}]}], " ", "}"}], ",", "k"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894369789542749*^9, 3.8943697915866423`*^9}, {
  3.8943698425028467`*^9, 3.894369906175479*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"e99fa36f-e9cc-4b0b-9e20-8bde0e513aa8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"A5coeff", "\[Rule]", 
   FractionBox[
    RowBox[{"40", " ", "\[ImaginaryI]", " ", "Rs3"}], "63"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894369894372553*^9, 3.89436990759026*^9}, 
   3.894370916488875*^9, 3.8943710430311613`*^9, 3.8943710743600283`*^9, {
   3.8943719644508123`*^9, 3.89437198532707*^9}, 3.8943722220631647`*^9, 
   3.894372555649124*^9, 3.8943805985925093`*^9},
 CellLabel->
  "Out[2093]=",ExpressionUUID->"13bd0aed-1016-4c0a-8865-63ed43b8ac15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols3", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"norm3A", " ", "*", " ", "A3coeff"}], "  ", "==", " ", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"FTCorrelator", "\[TensorProduct]", "Q3A"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "9"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm3B", " ", "*", " ", "B3coeff"}], " ", "==", " ", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"FTCorrelator", "\[TensorProduct]", "Q3B"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "9"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"A3coeff", ",", "B3coeff"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "k"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894370073987527*^9, 3.89437008479984*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"50eb7e57-0df5-4a1d-88ef-329b2e4e4d2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A3coeff", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", "15"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "Rs1"}], "+", "Rs3"}], ")"}]}]}], ",", 
   RowBox[{"B3coeff", "\[Rule]", 
    RowBox[{
     FractionBox["8", "45"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9", " ", "Rs1"}], "-", 
       RowBox[{"2", " ", "Rs3"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.894370085942412*^9, {3.89437091865475*^9, 3.894370939856184*^9}, {
   3.894371051678638*^9, 3.8943710744993153`*^9}, {3.894371982329565*^9, 
   3.8943719854631767`*^9}, 3.894372222201428*^9, 3.8943725557971354`*^9, 
   3.8943805987656393`*^9},
 CellLabel->
  "Out[2094]=",ExpressionUUID->"a02b2e37-8a75-4d26-95a0-396d3cb1053d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols1", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"norm1A", " ", "*", " ", "A1coeff"}], " ", "+", " ", 
           RowBox[{"A1dotB1", "*", "B1coeff"}]}], " ", "==", " ", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"FTCorrelator", "\[TensorProduct]", "Q1A"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "9"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"norm1B", " ", "*", " ", "B1coeff"}], " ", "+", " ", 
           RowBox[{"A1dotB1", "*", "A1coeff"}]}], " ", "==", " ", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"FTCorrelator", "\[TensorProduct]", "Q1B"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "9"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"A1coeff", ",", "B1coeff"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "k"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894370024478249*^9, 3.8943700411917963`*^9}, {
  3.894370098375984*^9, 3.8943701253507*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d98eedf8-2cc9-44c5-a7d3-d0b316adfde4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A1coeff", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["2", "105"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"14", " ", "Rs1"}], "+", 
       RowBox[{"3", " ", "Rs3"}]}], ")"}]}]}], ",", 
   RowBox[{"B1coeff", "\[Rule]", 
    RowBox[{
     FractionBox["8", "35"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"7", " ", "Rs1"}], "-", "Rs3"}], ")"}]}]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.89437012604926*^9, {3.894370921962953*^9, 3.894370941097636*^9}, 
   3.894371074640318*^9, 3.894371985585608*^9, 3.894372222351811*^9, 
   3.894372555950103*^9, 3.894380598900077*^9},
 CellLabel->
  "Out[2095]=",ExpressionUUID->"21a03cde-0b63-4ee0-a5d6-01ea763914b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TensorSymmetry", "[", "FTCorrelator", "]"}]], "Input",
 CellChangeTimes->{{3.894370696191577*^9, 3.894370703183004*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"3c3ba454-36bb-4e6d-b777-7506c68fb607"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8943707035919724`*^9, 3.894370944735024*^9, 
  3.8943710746656446`*^9, 3.894371985623204*^9, 3.8943722223783703`*^9, 
  3.8943725559767323`*^9, 3.894380598931982*^9},
 CellLabel->
  "Out[2096]=",ExpressionUUID->"311b6dcb-6dcf-4144-b571-ca76292a524d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"A1coeff", " ", "*", " ", "Q1A"}], " ", "+", 
      RowBox[{"B1coeff", " ", "*", " ", "Q1B"}], " ", "+", " ", 
      RowBox[{"A3coeff", " ", "*", " ", "Q3A"}], " ", "+", 
      RowBox[{"B3coeff", " ", "*", " ", "Q3B"}], " ", "+", " ", 
      RowBox[{"A5coeff", "*", "Legendre5kvec"}]}], "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"sols1", ",", "sols3", ",", "sols5"}], "]"}]}], "]"}], " ", "-",
    "FTCorrelator"}], "]"}]], "Input",
 CellChangeTimes->{{3.8943707614976377`*^9, 3.894370817495797*^9}, {
  3.894370951355541*^9, 3.894370951541024*^9}, {3.894371174834392*^9, 
  3.89437123589785*^9}, {3.894371270281155*^9, 3.8943712750845213`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"4328c0ca-18c8-46e4-9785-730c7a8f4221"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.894370817741877*^9, {3.894370945964525*^9, 3.894370953031167*^9}, 
   3.8943710031621428`*^9, 3.894371074686496*^9, {3.894371176319603*^9, 
   3.894371199256448*^9}, {3.894371231863556*^9, 3.894371236155837*^9}, {
   3.8943712754122868`*^9, 3.8943712782100058`*^9}, 3.8943719856392097`*^9, 
   3.894372222393368*^9, 3.894372555991955*^9, 3.894380598965598*^9},
 CellLabel->
  "Out[2097]=",ExpressionUUID->"cb7256f7-9b0f-4040-95bb-8ddabe80def1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{"sols1", ",", "sols3", ",", "sols5"}], "]"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"8abf78eb-184d-4e0b-8c08-5e36ba943671"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A1coeff", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["2", "105"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"14", " ", "Rs1"}], "+", 
       RowBox[{"3", " ", "Rs3"}]}], ")"}]}]}], ",", 
   RowBox[{"B1coeff", "\[Rule]", 
    RowBox[{
     FractionBox["8", "35"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"7", " ", "Rs1"}], "-", "Rs3"}], ")"}]}]}], ",", 
   RowBox[{"A3coeff", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", "15"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "Rs1"}], "+", "Rs3"}], ")"}]}]}], ",", 
   RowBox[{"B3coeff", "\[Rule]", 
    RowBox[{
     FractionBox["8", "45"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9", " ", "Rs1"}], "-", 
       RowBox[{"2", " ", "Rs3"}]}], ")"}]}]}], ",", 
   RowBox[{"A5coeff", "\[Rule]", 
    FractionBox[
     RowBox[{"40", " ", "\[ImaginaryI]", " ", "Rs3"}], "63"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8943808563562393`*^9},
 CellLabel->
  "Out[2166]=",ExpressionUUID->"b7594403-a7cf-4365-91de-5b7e7196d833"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projection of Fourier Transform into Helicity Basis", "Section",
 CellChangeTimes->{{3.894372247620613*^9, 3.894372281119706*^9}, {
  3.8943728848975153`*^9, 
  3.894372893896454*^9}},ExpressionUUID->"693b49f9-5600-4c0a-aa37-\
80c1666ab78e"],

Cell[CellGroupData[{

Cell["Define 2-point Shape Basis", "Subsection",
 CellChangeTimes->{{3.894268712834609*^9, 
  3.894268737499815*^9}},ExpressionUUID->"34332906-7fbf-47b0-90cb-\
a392fb741c13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eplus", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "I"}], ",", "0"}], "}"}]}]}], ";", " ", 
  RowBox[{"eminus", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"+", "I"}], ",", "0"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894269034274776*^9, 3.894269081105866*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"c9c9ef9c-f0c2-4121-9f0b-8b1b3bf6186c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Y0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"3", "/", "2"}], "]"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hatk", "\[TensorProduct]", "hatk"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"1", "/", "3"}], "*", "deltaK"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1p", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "/", "2"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hatk", "\[TensorProduct]", "eplus"}], " ", "+", " ", 
      RowBox[{"eplus", "\[TensorProduct]", "hatk"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1m", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "/", "2"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hatk", "\[TensorProduct]", "eminus"}], " ", "+", " ", 
      RowBox[{"eminus", "\[TensorProduct]", "hatk"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y2p", " ", "=", " ", 
   RowBox[{"eplus", "\[TensorProduct]", "eplus"}]}], ";", " ", 
  RowBox[{"Y2m", " ", "=", " ", 
   RowBox[{"eminus", "\[TensorProduct]", "eminus"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894269104224513*^9, 3.8942691462749853`*^9}, {
  3.8942692782701197`*^9, 3.8942694045125227`*^9}, {3.8942694413630953`*^9, 
  3.894269443116365*^9}, {3.8952191302444973`*^9, 
  3.895219133883752*^9}},ExpressionUUID->"250e9b8e-e1d0-4019-af39-\
dfcc38227db4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TensorContract", "[", 
  RowBox[{
   RowBox[{"Y2m", "\[TensorProduct]", "Y2m"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894269411292642*^9, 3.8942694781798887`*^9}, {
  3.894372906056944*^9, 3.894372906258403*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"a6dd4e7e-43c9-4cc8-8ee9-af39e020173d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.894269423325253*^9, 3.894269478540081*^9}, {
   3.8943729040089293`*^9, 3.894372906595406*^9}, 3.894380599017111*^9},
 CellLabel->
  "Out[2103]=",ExpressionUUID->"027b241e-ddfb-4908-86da-8feac95ef125"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baseP0", " ", "=", " ", 
   RowBox[{"Y0", "\[TensorProduct]", "Y0"}]}], ";", " ", 
  RowBox[{"normP0", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"baseP0", "\[TensorProduct]", "baseP0"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseP1", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Y1p", "\[TensorProduct]", "Y1m"}], " ", 
      StyleBox["+",
       FontSize->14], 
      RowBox[{
       StyleBox["Y1m",
        FontSize->14], "\[TensorProduct]", "Y1p"}]}], ")"}]}]}], ";", "  ", 
  RowBox[{"normP1", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"baseP1", "\[TensorProduct]", "baseP1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseP2", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Y2p", "\[TensorProduct]", "Y2m"}], " ", "+", 
      RowBox[{"Y2m", "\[TensorProduct]", "Y2p"}]}], ")"}]}]}], ";", " ", 
  RowBox[{"normP2", " ", "=", " ", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"baseP2", "\[TensorProduct]", "baseP2"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89426952945251*^9, 3.894269578761126*^9}, {
  3.894269968868205*^9, 3.894269978089837*^9}, {3.8943074888834743`*^9, 
  3.894307532835443*^9}, {3.894307584636785*^9, 3.894307600009802*^9}, {
  3.894373123255349*^9, 3.894373146019907*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"150c19fe-3024-46e2-aa73-f6c9f3829de9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"basis2pts", " ", "=", 
   RowBox[{"{", 
    RowBox[{"baseP0", ",", "baseP1", ",", "baseP2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm2pts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"normP0", ",", " ", "normP1", ",", " ", "normP2"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.894269279328491*^9, 3.894269284635441*^9}, {
   3.8942697595948553`*^9, 3.894269858175865*^9}, 3.894270039084588*^9, {
   3.894372979146084*^9, 3.894373012726247*^9}, {3.894373157824006*^9, 
   3.8943731704577847`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"3235937b-b509-4dd5-a503-d8b5e61e220e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8942699943562183`*^9, 3.894270035503377*^9}, {
  3.89437301921833*^9, 3.894373034302238*^9}, {3.894373066950598*^9, 
  3.8943731016338987`*^9}, {3.8943731484988413`*^9, 3.8943731811762667`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"24f0e112-6ffd-4e59-907e-31e332ea9e2a"]
}, Open  ]],

Cell["Construct Same Basis but in Configuration Space", "Subsection",
 CellChangeTimes->{{3.894372287379669*^9, 
  3.894372293313094*^9}},ExpressionUUID->"871b4b37-e9af-4b22-ac32-\
0c112c412a7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["P1 Basis", "Section",
 CellChangeTimes->{{3.89436747197188*^9, 
  3.894367477959483*^9}},ExpressionUUID->"7ec406f6-4379-4234-9b8f-\
031daa2e2219"],

Cell[CellGroupData[{

Cell["Generate Tensor Basis", "Subsubsection",
 CellChangeTimes->{{3.894361833774434*^9, 3.894361843447666*^9}, {
  3.894367439028159*^9, 
  3.8943674535627527`*^9}},ExpressionUUID->"d7c1d0e7-59eb-4a95-a291-\
499cd1a94a84"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1", " ", "=", " ", 
   RowBox[{
   "hatq", "\[TensorProduct]", "deltaK", "\[TensorProduct]", "deltaK"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E1", "]"}]}], "Input",
 CellChangeTimes->{{3.8943618500357113`*^9, 3.8943618805976343`*^9}, {
   3.8943622987322893`*^9, 3.8943623300650187`*^9}, {3.894362483687097*^9, 
   3.894362499156934*^9}, 3.8943628193142757`*^9, {3.894363061467105*^9, 
   3.89436306230051*^9}, 3.8943723363558617`*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"3f04d1e6-d515-4ac9-b8b5-7f5e5bf5698a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8943624997032957`*^9, 3.8943628199067583`*^9, 
  3.894363063120429*^9, 3.89436930138041*^9, 3.894369463947075*^9, 
  3.894371073460421*^9, 3.894371930607293*^9, 3.894371984518251*^9, 
  3.894372221159984*^9, 3.894372374582685*^9, 3.894372491886979*^9, 
  3.8943725560173903`*^9, 3.894380599068673*^9},
 CellLabel->
  "Out[2111]=",ExpressionUUID->"2a95fc13-6e78-4775-83ce-87cefe173a01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E2", " ", "=", " ", 
   RowBox[{"hatq", "\[TensorProduct]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
       RowBox[{"deltaK", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "l"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E2", "]"}]}], "Input",
 CellChangeTimes->{{3.894361882045842*^9, 3.8943619136212873`*^9}, {
   3.894362116105892*^9, 3.8943621670596313`*^9}, {3.894362216772059*^9, 
   3.894362249546924*^9}, {3.894362338759591*^9, 3.894362348710864*^9}, 
   3.894362407894953*^9, {3.8943624562071857`*^9, 3.8943624815070457`*^9}, 
   3.894362807785542*^9, {3.894363066362694*^9, 3.894363066778392*^9}, 
   3.8943723391565647`*^9, {3.894372546815324*^9, 3.894372547892796*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"3832a264-0b73-447e-af31-25b8cc02c8fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894362481833087*^9, 3.8943625011393127`*^9}, 
   3.894362808708968*^9, 3.8943630671035137`*^9, 3.894369301394163*^9, 
   3.894369463960919*^9, 3.894371073474671*^9, 3.894371930619685*^9, 
   3.8943719845305033`*^9, 3.894372221174469*^9, 3.894372376657144*^9, 
   3.89437249379244*^9, 3.894372556043169*^9, 3.894380599099938*^9},
 CellLabel->
  "Out[2114]=",ExpressionUUID->"14a3985d-6980-43f5-b285-40d4d203607f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hatq", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "b"}], "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E3", "]"}]}], "Input",
 CellChangeTimes->{{3.894362442249929*^9, 3.894362448078806*^9}, {
   3.894362507449637*^9, 3.894362760260476*^9}, {3.894362800249898*^9, 
   3.894362812758575*^9}, {3.894363070312348*^9, 3.894363070607553*^9}, 
   3.894372343644703*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"cc075b7d-9d9f-497b-8d35-d75dda1ff96c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894362688845414*^9, 3.894362761773837*^9}, {
   3.8943628058357058`*^9, 3.89436281327525*^9}, 3.894363070997901*^9, 
   3.894369301426708*^9, 3.894369463990552*^9, 3.894371073505763*^9, 
   3.894371930645961*^9, 3.8943719845553493`*^9, 3.894372221201195*^9, 
   3.894372380481462*^9, 3.8943724952062283`*^9, 3.894372556069265*^9, 
   3.894380599130954*^9},
 CellLabel->
  "Out[2118]=",ExpressionUUID->"d6e50eb6-2108-4cce-9c7a-2502cea6c267"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hatq", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "c"}], "]"}], "]"}], "*", 
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"b", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E4", " ", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E4", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E4", "]"}]}], "Input",
 CellChangeTimes->{{3.894362835743816*^9, 3.894362963429187*^9}, {
   3.894363078194256*^9, 3.894363080961378*^9}, 3.8943723447318373`*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"17a06840-29a8-4b90-ada7-8c4a30d16f3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.894362963825506*^9, {3.894363078982925*^9, 3.894363081821402*^9}, 
   3.894369301460051*^9, 3.894369464022876*^9, 3.894371073536685*^9, 
   3.89437193067426*^9, 3.894371984581723*^9, 3.8943722212403927`*^9, 
   3.894372382025506*^9, 3.8943724967183523`*^9, 3.8943725560958357`*^9, 
   3.8943805991624813`*^9},
 CellLabel->
  "Out[2123]=",ExpressionUUID->"294215d5-395f-475b-b43e-228111223608"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8943622530695467`*^9, 3.8943622936228952`*^9}, {
  3.894362599629867*^9, 3.894362620879458*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"ce9a8244-8850-4fb6-a636-759a16ae4d18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"TensorContract", "[", 
   RowBox[{
    RowBox[{"E2", "\[TensorProduct]", "E1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.89437250988783*^9, 3.894372516340054*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"b52135bb-6f5d-4fc2-96fc-6935aa6801d8"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.894372512852953*^9, 3.894372516730159*^9}, 
   3.894372556174254*^9, 3.8943805992415333`*^9},
 CellLabel->
  "Out[2125]=",ExpressionUUID->"8614c3f1-d40c-4ce0-8c64-ba00c600d39f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form Basis", "Subsection",
 CellChangeTimes->{{3.894364462109634*^9, 
  3.894364483217211*^9}},ExpressionUUID->"6366ba68-6c0c-4297-bc68-\
ce85fa1a5d40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q1Aq", " ", "=", " ", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A1", "*", "E1"}], "+", 
         RowBox[{"A2", "*", "E2"}], "+", 
         RowBox[{"A3", "*", "E3"}], "+", 
         RowBox[{"A4", "*", "E4"}]}], ")"}], "/.", 
       RowBox[{"solsp1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "1"}], ",", 
      RowBox[{"A3", "->", "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q1Bq", " ", "=", " ", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A1", "*", "E1"}], "+", 
         RowBox[{"A2", "*", "E2"}], "+", 
         RowBox[{"A3", "*", "E3"}], "+", 
         RowBox[{"A4", "*", "E4"}]}], ")"}], "/.", 
       RowBox[{"solsp1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "0"}], ",", 
      RowBox[{"A3", "->", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894364485708267*^9, 3.894364538622735*^9}, {
  3.894364574787657*^9, 3.894364575499351*^9}, {3.894364718682025*^9, 
  3.894364740796955*^9}, {3.894369424589559*^9, 3.8943694293441896`*^9}, {
  3.894372186912157*^9, 3.894372188572081*^9}, {3.8943723938019667`*^9, 
  3.894372395249927*^9}, {3.894380510404821*^9, 3.894380513438676*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"730921bf-9f2b-415e-8bb3-99eb10f784fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dot Products", "Subsection",
 CellChangeTimes->{{3.8943731905450897`*^9, 
  3.8943732009365883`*^9}},ExpressionUUID->"54b9e0da-0fa7-4c8a-89a8-\
fcb05c0da3ad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "4"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "       ", 
   RowBox[{
    RowBox[{"basisvec", " ", "=", " ", 
     RowBox[{"basis2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "       ", 
    RowBox[{"normvec", " ", "=", " ", 
     RowBox[{"norm2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "               ", 
    "\[IndentingNewLine]", 
    RowBox[{"Aproj", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q1Aq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Bproj", "=", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q1Bq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Aproj", ",", " ", "\"\<,\>\"", ",", "  ", "Bproj"}], "]"}]}]}], 
  "\[IndentingNewLine]", "     ", "]"}]], "Input",
 CellChangeTimes->{{3.894373203376992*^9, 3.8943734874441433`*^9}, {
  3.8943805161210938`*^9, 3.894380519418751*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"0857a6db-268b-4536-be33-2ba4a1fd56dc"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"3", " ", "\[Mu]"}], "\[InvisibleSpace]", "\<\",\"\>", 
   "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"3", " ", "\[Mu]"}], "2"]}],
  SequenceForm[3 $CellContext`\[Mu], ",", Rational[3, 2] $CellContext`\[Mu]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, 
   3.894380599300735*^9},
 CellLabel->
  "During evaluation of \
In[2128]:=",ExpressionUUID->"0a5245cd-aa0f-46d9-9769-f1555fccb22b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "6"}], " ", "\[Mu]"}], "\[InvisibleSpace]", "\<\",\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"5", " ", "\[Mu]"}], "2"]}]}],
  SequenceForm[(-6) $CellContext`\[Mu], ",", 
   Rational[-5, 2] $CellContext`\[Mu]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, 
   3.894380599330715*^9},
 CellLabel->
  "During evaluation of \
In[2128]:=",ExpressionUUID->"7e646804-e8a2-4a8c-a40c-4cead5765f5d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"6", " ", "\[Mu]"}], "\[InvisibleSpace]", "\<\",\"\>", 
   "\[InvisibleSpace]", "\[Mu]"}],
  SequenceForm[6 $CellContext`\[Mu], ",", $CellContext`\[Mu]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, 
   3.894380599360325*^9},
 CellLabel->
  "During evaluation of \
In[2128]:=",ExpressionUUID->"e85d4d39-5dfc-4b01-a029-0a3b9f24d667"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P3 Basis", "Section",
 CellChangeTimes->{{3.894367488626202*^9, 
  3.894367495546835*^9}},ExpressionUUID->"1f2231ef-508a-4e71-b17a-\
70de75fd9f50"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894373699893304*^9, 3.894373703799452*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"1aa9c84a-6dc5-4a41-9c35-f7654682c114"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Legendre3qvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", "*", 
       RowBox[{
       "hatq", "\[TensorProduct]", "hatq", "\[TensorProduct]", "hatq"}]}], 
      "-", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "*", 
          RowBox[{"hatq", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], " ", "+", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"j", ",", "k"}], "]"}], "*", 
          RowBox[{"hatq", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"k", ",", "i"}], "]"}], "*", 
          RowBox[{"hatq", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], "  ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.894367552029729*^9, 3.894367573135841*^9}, {
  3.894372639383026*^9, 3.8943726513251*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"04879cc7-598f-42b3-a48b-ea3af737974f"],

Cell[CellGroupData[{

Cell["Generate Tensor Basis", "Subsection",
 CellChangeTimes->{{3.8943675889703283`*^9, 
  3.894367600175775*^9}},ExpressionUUID->"3997b963-dbf6-48a0-b33e-\
604bd56950db"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"a", ",", "b"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3qvec", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E1", "]"}]}], "Input",
 CellChangeTimes->{{3.894367630548313*^9, 3.894367723191292*^9}, {
  3.894367809361079*^9, 3.894367812621285*^9}, {3.894368530241671*^9, 
  3.894368531487979*^9}, {3.894373681944374*^9, 3.894373705783585*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"2f05f8f4-f619-4840-a21e-90677aefd9ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8943678133327017`*^9, 3.894368533975552*^9, 3.894368581733889*^9, 
   3.894369301790821*^9, 3.894369464325076*^9, 3.8943710738497267`*^9, 
   3.894371931015026*^9, 3.89437198485703*^9, 3.8943722215348454`*^9, 
   3.894372555165501*^9, 3.894372673563051*^9, 3.894373551785318*^9, {
   3.894373683757635*^9, 3.894373706367144*^9}, 3.8943805994877462`*^9},
 CellLabel->
  "Out[2133]=",ExpressionUUID->"49a7b0d1-d24f-467a-b7c3-f205f4f8d588"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "a"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3qvec", "[", 
       RowBox[{"[", 
        RowBox[{"b", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E2", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E2", "]"}]}], "Input",
 CellChangeTimes->{{3.89436774102514*^9, 3.8943677582214127`*^9}, {
  3.894367829052208*^9, 3.894367889211183*^9}, {3.894368133198504*^9, 
  3.894368139099556*^9}, {3.894368536016925*^9, 3.894368537882945*^9}, {
  3.894373708440893*^9, 3.894373708569079*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"ac060537-57d4-4a84-8cf2-b7add9e3be0b"],

Cell[BoxData[
 RowBox[{"Symmetric", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.894368180164811*^9, 3.8943683263674726`*^9, 
  3.894368539486864*^9, 3.894369301818392*^9, 3.894369464350709*^9, 
  3.894371073880322*^9, 3.894371931073103*^9, 3.89437198488216*^9, 
  3.894372221564515*^9, 3.894372555190796*^9, 3.8943726748401527`*^9, 
  3.8943735529692297`*^9, 3.8943737091870813`*^9, 3.89438059955068*^9},
 CellLabel->
  "Out[2137]=",ExpressionUUID->"f52ed775-731f-4f92-bf79-b3e6e4113019"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaK", "[", 
       RowBox[{"[", 
        RowBox[{"a", ",", "c"}], "]"}], "]"}], "*", 
      RowBox[{"Legendre3qvec", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "b", ",", "d"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Symmetrize", "[", 
     RowBox[{"E3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TensorSymmetry", "[", "E3", "]"}]}], "Input",
 CellChangeTimes->{{3.894368194597445*^9, 3.8943682086086597`*^9}, {
  3.8943682916518593`*^9, 3.894368318678885*^9}, {3.894368541282106*^9, 
  3.894368546799258*^9}, {3.894373710646163*^9, 3.894373710793313*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"b689c927-0fbb-458e-8d98-79be29048ba7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}], "}"}], "]"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.894368297703614*^9, 3.894368319326886*^9}, {
   3.8943685437699614`*^9, 3.894368547469776*^9}, 3.894369301846115*^9, 
   3.894369464377223*^9, 3.894371073910809*^9, 3.894371931155753*^9, 
   3.894371984906177*^9, 3.894372221594542*^9, 3.8943725552141037`*^9, 
   3.894372677185132*^9, 3.89437355400907*^9, 3.894373711321617*^9, 
   3.8943805996487637`*^9},
 CellLabel->
  "Out[2142]=",ExpressionUUID->"df3124ef-a249-4341-9bff-6f6771c0a4e2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894368414379746*^9, 3.894368450026244*^9}, {
  3.8943685238901*^9, 3.8943685249782867`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"f558bc53-d963-4482-b564-91ca0466b4de"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894368328104404*^9, 3.89436834298425*^9}, {
  3.894368562349195*^9, 3.894368596898797*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7dd48178-f884-4f63-bb91-947db9811110"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8943737438484898`*^9, 3.894373760841373*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"506e82df-6ce2-4af3-8657-b41593b4e4ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Trace: Now it will be proportional to Picd", "Subsection",
 CellChangeTimes->{{3.89436870306085*^9, 
  3.89436871984062*^9}},ExpressionUUID->"091af4bf-ba97-45a9-9065-\
ba5c91d27333"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q3Aq", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"I", "^", "3"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A1", "*", "E1"}], "+", 
         RowBox[{"A2", "*", "E2"}], "+", 
         RowBox[{"A3", "*", "E3"}]}], ")"}], "/.", 
       RowBox[{"solsp3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "1"}], ",", 
      RowBox[{"A2", "->", "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3Bq", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"I", "^", "3"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A1", "*", "E1"}], "+", 
         RowBox[{"A2", "*", "E2"}], "+", 
         RowBox[{"A3", "*", "E3"}]}], ")"}], "/.", 
       RowBox[{"solsp3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A1", "->", "0"}], ",", 
      RowBox[{"A2", "->", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.894368994857067*^9, 3.894369026958706*^9}, {
  3.894372199708757*^9, 3.894372201649897*^9}, {3.894373531328527*^9, 
  3.894373532421565*^9}, {3.894380527194323*^9, 3.894380532449088*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"b1818e8c-1769-4f6e-a532-429142f6ce3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q3Aqnew", "=", 
   RowBox[{"Q3Aq", "+", "Q3Bq"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3Bqnew", " ", "=", " ", 
   RowBox[{"Q3Aq", "-", "Q3Bq"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3Aq", " ", "=", " ", "Q3Aqnew"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q3Bq", "=", "  ", "Q3Bqnew"}], ";"}]}], "Input",
 CellChangeTimes->{{3.894369147799514*^9, 3.894369254887151*^9}, {
  3.8943735399474277`*^9, 3.894373582792585*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"b8f2c901-daa1-49fb-97ad-bb476d461efa"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894372725095705*^9, 3.894372745583535*^9}, {
  3.894373791481594*^9, 3.8943737969023867`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"4c156451-30a7-4321-9da5-686d9945ed62"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.89437377709006*^9, 3.894373804357204*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"5a73c534-7807-4715-9d3c-8857e56d34f1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894369263250235*^9, 3.894369272801207*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"794a7850-2eb4-4323-9a73-5413f5ba3a15"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dot Products", "Subsection",
 CellChangeTimes->{{3.8943731905450897`*^9, 
  3.8943732009365883`*^9}},ExpressionUUID->"b8b997e9-3be8-4eef-826d-\
cf9e06d43b89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "4"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "       ", 
   RowBox[{
    RowBox[{"basisvec", " ", "=", " ", 
     RowBox[{"basis2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "       ", 
    RowBox[{"normvec", " ", "=", " ", 
     RowBox[{"norm2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "               ", 
    "\[IndentingNewLine]", 
    RowBox[{"Aproj", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q3Aq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Bproj", "=", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q3Bq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Aproj", ",", " ", "\"\<,\>\"", ",", "  ", "Bproj"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8943744187261667`*^9, 3.8943744340750732`*^9}, {
  3.894380536558614*^9, 3.8943805386931677`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"078bb3f9-001d-4932-80c3-171eac70cbbe"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["3", "4"], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"3", "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}],
  SequenceForm[
  0, ",", Rational[3, 4] $CellContext`\[Mu] (3 - 5 $CellContext`\[Mu]^2)],
  Editable->False]], "Print",
 CellChangeTimes->{3.894374434818965*^9, 3.894380599975581*^9},
 CellLabel->
  "During evaluation of \
In[2155]:=",ExpressionUUID->"ababe14f-2c88-4609-9cea-301b12b1020f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"3", "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}],
  SequenceForm[$CellContext`\[Mu] (-3 + 5 $CellContext`\[Mu]^2), ",", 
   Rational[1, 4] $CellContext`\[Mu] (3 - 5 $CellContext`\[Mu]^2)],
  Editable->False]], "Print",
 CellChangeTimes->{3.894374434818965*^9, 3.8943806001576843`*^9},
 CellLabel->
  "During evaluation of \
In[2155]:=",ExpressionUUID->"2fc9a803-088f-4bbe-91fc-fe82f03ada4c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}],
  SequenceForm[$CellContext`\[Mu] (-3 + 5 $CellContext`\[Mu]^2), ",", 
   Rational[1, 2] $CellContext`\[Mu] (-3 + 5 $CellContext`\[Mu]^2)],
  Editable->False]], "Print",
 CellChangeTimes->{3.894374434818965*^9, 3.894380600339486*^9},
 CellLabel->
  "During evaluation of \
In[2155]:=",ExpressionUUID->"1879e8fc-08ca-4faf-b413-9b35edd9090d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "4"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "       ", 
   RowBox[{
    RowBox[{"basisvec", " ", "=", " ", 
     RowBox[{"basis2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "       ", 
    RowBox[{"normvec", " ", "=", " ", 
     RowBox[{"norm2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "               ", 
    "\[IndentingNewLine]", 
    RowBox[{"Aproj", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q3Aq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", 
    RowBox[{"Aproj", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "3"}], "+", "1"}], ")"}], "/", "2"}], "*", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LegendreP", "[", 
          RowBox[{"3", ",", "\[Mu]"}], "]"}], "*", "Aproj"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Bproj", "=", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Q3Bq"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", 
    RowBox[{"Bproj", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "3"}], "+", "1"}], ")"}], "/", "2"}], "*", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LegendreP", "[", 
          RowBox[{"3", ",", "\[Mu]"}], "]"}], "*", "Bproj"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Aproj", ",", " ", "\"\<,\>\"", ",", "  ", "Bproj"}], "]"}]}]}], 
  "\[IndentingNewLine]", "     ", "]"}]], "Input",
 CellChangeTimes->{{3.894373203376992*^9, 3.8943734874441433`*^9}, {
   3.894373563678212*^9, 3.894373567040028*^9}, {3.894374349550675*^9, 
   3.894374406687813*^9}, 3.89437449397304*^9, {3.894380546899987*^9, 
   3.894380549005705*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"549849c0-b0ba-48a6-9ee9-6b4a368c0e5e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["3", "2"]}]}],
  SequenceForm[0, ",", 
   Rational[-3, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373807742079*^9, {
   3.894374407566684*^9, 3.894374436613497*^9}, 3.8943745052985897`*^9, 
   3.8943806005415993`*^9},
 CellLabel->
  "During evaluation of \
In[2156]:=",ExpressionUUID->"182f3f2e-4e5b-45ba-9ac2-c5403305bc3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", "2"]}]}],
  SequenceForm[2, ",", 
   Rational[-1, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373807742079*^9, {
   3.894374407566684*^9, 3.894374436613497*^9}, 3.8943745052985897`*^9, 
   3.894380600730069*^9},
 CellLabel->
  "During evaluation of \
In[2156]:=",ExpressionUUID->"b58ff2be-9556-4f3f-82e6-de53177e7b6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2", "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm[2, ",", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373807742079*^9, {
   3.894374407566684*^9, 3.894374436613497*^9}, 3.8943745052985897`*^9, 
   3.8943806009171667`*^9},
 CellLabel->
  "During evaluation of \
In[2156]:=",ExpressionUUID->"6993ff42-d7ad-4659-89b2-a5193b5ca017"]
}, Open  ]]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.894372623201847*^9, 3.894372626868022*^9}, 
   3.8943735156820498`*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"19a2d63b-074e-4982-a7ff-7c9e000ed65d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P5 Basis", "Section",
 CellChangeTimes->{{3.894369363471979*^9, 
  3.894369367131895*^9}},ExpressionUUID->"6b941f72-fbe5-4d10-aee0-\
354381eee19e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Legendre5kvec5", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "8"}], " ", "*", " ", "63", " ", "*", " ", 
    RowBox[{
    "hatq", "\[TensorProduct]", "hatq", "\[TensorProduct]", "hatq", 
     "\[TensorProduct]", "hatq", "\[TensorProduct]", "hatq"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5kvec3", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", "1"}], "/", "8"}], "*", "7", "*", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "l"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"deltaK", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symdeltadelta", " ", "=", " ", 
   RowBox[{"3", "*", 
    RowBox[{"Normal", "[", 
     RowBox[{"Symmetrize", "[", 
      RowBox[{
       RowBox[{"deltaK", "\[TensorProduct]", "deltaK"}], ",", 
       RowBox[{"Symmetric", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5kvec1", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "8"}], "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"hatq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatq", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatq", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i", ",", "l", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatq", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "i", ",", "m"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"hatq", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "*", 
        RowBox[{"symdeltadelta", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k", ",", "l", ",", "i"}], "]"}], "]"}]}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Legendre5qvec", "=", 
   RowBox[{
    RowBox[{"I", "^", "5"}], "*", 
    RowBox[{"(", 
     RowBox[{"Legendre5kvec1", "+", "Legendre5kvec3", "+", "Legendre5kvec5"}],
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.894369379287842*^9, 3.894369396608268*^9}, {
  3.894372090767974*^9, 3.894372101053504*^9}, {3.89437279216016*^9, 
  3.894372809478861*^9}, {3.894373654370657*^9, 3.8943736579250517`*^9}, {
  3.894380558049799*^9, 3.894380562875177*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"e982d529-bf6c-460a-9655-aec786b41b25"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.894369410568412*^9, 3.894369413417656*^9}, {
  3.89436946836376*^9, 3.894369477127583*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"08c73c88-5636-43a0-add3-1c02fb749ebc"],

Cell[CellGroupData[{

Cell["Dot Products", "Subsection",
 CellChangeTimes->{{3.8943731905450897`*^9, 
  3.8943732009365883`*^9}},ExpressionUUID->"105516dd-a3aa-4300-87eb-\
ab93a0b5e34e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "4"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "       ", 
   RowBox[{
    RowBox[{"basisvec", " ", "=", " ", 
     RowBox[{"basis2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "       ", 
    RowBox[{"normvec", " ", "=", " ", 
     RowBox[{"norm2pts", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "               ", 
    "\[IndentingNewLine]", 
    RowBox[{"Aproj", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", " ", 
      RowBox[{
       RowBox[{"TensorContract", "[", 
        RowBox[{
         RowBox[{"basisvec", "\[TensorProduct]", 
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{"I", "*", 
             RowBox[{"hatk", "\[TensorProduct]", "Legendre5qvec"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
       "normvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "Aproj", "]"}]}]}], "\[IndentingNewLine]", "     ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.894373203376992*^9, 3.8943734874441433`*^9}, {
  3.894373563678212*^9, 3.894373567040028*^9}, {3.894373633451462*^9, 
  3.8943736632951*^9}, {3.894380569803175*^9, 3.894380570138616*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"b6524814-ab16-40e7-8612-d0165b2e4784"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["3", "16"]}], " ", "\[Mu]", " ", 
  RowBox[{"(", 
   RowBox[{"15", "-", 
    RowBox[{"70", " ", 
     SuperscriptBox["\[Mu]", "2"]}], "+", 
    RowBox[{"63", " ", 
     SuperscriptBox["\[Mu]", "4"]}]}], ")"}]}]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373663801119*^9, 
   3.894380601151308*^9},
 CellLabel->
  "During evaluation of \
In[2164]:=",ExpressionUUID->"9f92d13e-d0f2-4201-b1e6-a57d4149a139"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "15"}], " ", "\[Mu]"}], "+", 
    RowBox[{"70", " ", 
     SuperscriptBox["\[Mu]", "3"]}], "-", 
    RowBox[{"63", " ", 
     SuperscriptBox["\[Mu]", "5"]}]}], ")"}]}]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373663801119*^9, 
   3.8943806012427692`*^9},
 CellLabel->
  "During evaluation of \
In[2164]:=",ExpressionUUID->"67f92211-bf9c-4a3e-ae9d-8f4afe4e91f1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "15"}], " ", "\[Mu]"}], "+", 
    RowBox[{"70", " ", 
     SuperscriptBox["\[Mu]", "3"]}], "-", 
    RowBox[{"63", " ", 
     SuperscriptBox["\[Mu]", "5"]}]}], ")"}]}]], "Print",
 CellChangeTimes->{{3.8943734830288153`*^9, 3.894373487933422*^9}, {
   3.894373568338619*^9, 3.894373594511776*^9}, 3.894373663801119*^9, 
   3.894380601333763*^9},
 CellLabel->
  "During evaluation of \
In[2164]:=",ExpressionUUID->"cf144932-6e24-4aee-ac7d-985b907e8e7b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "4"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "       ", 
    RowBox[{
     RowBox[{"basisvec", " ", "=", " ", 
      RowBox[{"basis2pts", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "       ", 
     RowBox[{"normvec", " ", "=", " ", 
      RowBox[{"norm2pts", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "               ", 
     "\[IndentingNewLine]", 
     RowBox[{"Aproj", " ", "=", " ", 
      RowBox[{"FullSimplify", "[", " ", 
       RowBox[{
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"basisvec", "\[TensorProduct]", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"I", "*", 
              RowBox[{"hatk", "\[TensorProduct]", "Legendre5qvec"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "7"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "]"}], "/", 
        "normvec"}], "]"}]}], ";", 
     RowBox[{"Aproj", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "5"}], "+", "1"}], ")"}], "/", "2"}], "*", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LegendreP", "[", 
           RowBox[{"5", ",", "\[Mu]"}], "]"}], "*", "Aproj"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "Aproj", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.894372623201847*^9, 3.894372626868022*^9}, 
   3.8943735156820498`*^9, {3.894374456035447*^9, 3.894374488492237*^9}, {
   3.89438059191066*^9, 3.894380592159602*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"4d679a41-7ebe-4d61-a01d-bad2a3f8f054"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["3", "2"]}]], "Print",
 CellChangeTimes->{3.89437448906109*^9, 3.8943806014450397`*^9},
 CellLabel->
  "During evaluation of \
In[2165]:=",ExpressionUUID->"12e2b12b-2987-4052-a9e0-e51c936eee90"],

Cell[BoxData[
 RowBox[{"-", "2"}]], "Print",
 CellChangeTimes->{3.89437448906109*^9, 3.894380601536716*^9},
 CellLabel->
  "During evaluation of \
In[2165]:=",ExpressionUUID->"c16ce6db-6232-48de-9507-c24511235964"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", "2"]}]], "Print",
 CellChangeTimes->{3.89437448906109*^9, 3.894380601625609*^9},
 CellLabel->
  "During evaluation of \
In[2165]:=",ExpressionUUID->"a6b25e02-56b4-47e7-80a5-c4a836b9946f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1038, 899},
WindowMargins->{{Automatic, 414}, {Automatic, 99}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"66cb22f9-e6c4-4fbb-8eef-a76fde02301a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 225, 4, 45, "Subsubsection",ExpressionUUID->"a7d4dc25-381c-4aa8-8239-3ccb919caa2b"],
Cell[808, 28, 1085, 29, 94, "Input",ExpressionUUID->"c136babb-20c5-4a38-b695-87a261ca5393"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1930, 62, 152, 3, 67, "Section",ExpressionUUID->"607a69c2-8a9e-49ca-a536-3cce894d4932"],
Cell[CellGroupData[{
Cell[2107, 69, 223, 4, 45, "Subsubsection",ExpressionUUID->"22cf7621-163e-46ee-a17b-b62c0598c93c"],
Cell[CellGroupData[{
Cell[2355, 77, 558, 11, 52, "Input",ExpressionUUID->"e98553f6-ef10-4616-b75a-0295b0514859"],
Cell[2916, 90, 1048, 32, 34, "Output",ExpressionUUID->"9c6db09f-5dad-4b19-8b86-594963d7ec84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4001, 127, 1537, 38, 73, "Input",ExpressionUUID->"274ea203-ff6b-4ba5-af94-caf4f4668f00"],
Cell[5541, 167, 1082, 33, 34, "Output",ExpressionUUID->"55775697-4af1-40e4-a921-4cdba19d796e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6660, 205, 1891, 53, 94, "Input",ExpressionUUID->"0b9a260f-e1cb-4f3c-9798-f9d13a231e47"],
Cell[8554, 260, 1103, 33, 34, "Output",ExpressionUUID->"9bf22a95-f4bf-498b-a22e-467cb8b951e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9694, 298, 2066, 61, 115, "Input",ExpressionUUID->"a32569f9-c3c8-41d4-9cfa-0bd9900f24ac"],
Cell[11763, 361, 1054, 33, 34, "Output",ExpressionUUID->"20be50c2-eb12-48f6-9e68-1ca8fa7f08a3"]
}, Open  ]],
Cell[12832, 397, 224, 3, 30, "Input",ExpressionUUID->"4b43a6a3-b0e2-427c-8cc1-639dbb8b1e86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13093, 405, 227, 5, 54, "Subsection",ExpressionUUID->"062d403c-83df-4b9a-8c0c-c1f3175496ab"],
Cell[13323, 412, 1024, 29, 52, "Input",ExpressionUUID->"9ebf9c3b-dcce-4cb6-beb5-fc44d9c61292"],
Cell[CellGroupData[{
Cell[14372, 445, 650, 17, 30, "Input",ExpressionUUID->"de24611d-f290-414e-96a8-aa0755e7dfe8"],
Cell[15025, 464, 544, 12, 34, "Output",ExpressionUUID->"f4251bc6-3f92-445b-994d-b7c5fef75d7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15606, 481, 557, 15, 30, "Input",ExpressionUUID->"900377fd-2098-4e7a-8285-66c676b829ba"],
Cell[16166, 498, 498, 11, 34, "Output",ExpressionUUID->"fd78399c-0a20-4b80-a673-7d78508507ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16701, 514, 604, 16, 30, "Input",ExpressionUUID->"1ec4b974-ee86-437b-9a8c-1cbe26fbacd8"],
Cell[17308, 532, 567, 13, 49, "Output",ExpressionUUID->"06d69622-7665-49e2-97f7-8879433430e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17912, 550, 603, 16, 30, "Input",ExpressionUUID->"d650a51f-6b9f-4235-8bb6-6ebc66a5b6c4"],
Cell[18518, 568, 540, 12, 49, "Output",ExpressionUUID->"db867356-f520-4d6a-8e5c-3d843f4c1846"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19095, 585, 1242, 35, 52, "Input",ExpressionUUID->"54fe56e7-c10c-4501-8564-75acd2996835"],
Cell[20340, 622, 627, 13, 28, "Message",ExpressionUUID->"81b0b2e0-941a-460a-b09a-df387b8159d1"],
Cell[20970, 637, 738, 19, 34, "Output",ExpressionUUID->"6e1b43b3-970b-4544-bb47-4f845759b439"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21745, 661, 1278, 35, 73, "Input",ExpressionUUID->"290ef329-d359-4999-b70d-5783b2c8d2b1"],
Cell[23026, 698, 732, 20, 49, "Output",ExpressionUUID->"76774e60-c17c-4261-b56c-bf8b58192f16"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23807, 724, 158, 3, 54, "Subsection",ExpressionUUID->"6e708792-b0f2-4887-9b03-64172e40e7a2"],
Cell[23968, 729, 1401, 39, 52, "Input",ExpressionUUID->"24a63eeb-389d-4342-8be9-7e8c0fbab9d5"],
Cell[25372, 770, 1949, 58, 73, "Input",ExpressionUUID->"c2d26f73-faba-4e96-ad38-ee51e19fdfd8"],
Cell[27324, 830, 271, 4, 30, "Input",ExpressionUUID->"f9cdcf4a-5b37-440e-9ed2-aa6482951406"],
Cell[27598, 836, 171, 2, 30, "Input",ExpressionUUID->"a4340ddd-eff8-4e18-bc3e-9d6a3cdc3b0d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27818, 844, 153, 3, 67, "Section",ExpressionUUID->"cf76b427-a545-490c-a461-c582ccb31c02"],
Cell[27974, 849, 1358, 37, 94, "Input",ExpressionUUID->"d2b5f316-3db3-4880-b227-d2aea47de6b6"],
Cell[CellGroupData[{
Cell[29357, 890, 171, 3, 54, "Subsection",ExpressionUUID->"1b907591-ea97-4458-9b25-b4eed346d9b2"],
Cell[CellGroupData[{
Cell[29553, 897, 1491, 42, 73, "Input",ExpressionUUID->"3df78be4-5cfa-4f09-95d5-e2200e9962ef"],
Cell[31047, 941, 1050, 32, 34, "Output",ExpressionUUID->"e5402b11-e619-43b6-b790-0d6228cfa236"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32134, 978, 1807, 51, 94, "Input",ExpressionUUID->"714cf7cb-0aa0-4cff-9272-94478ed4bcfa"],
Cell[33944, 1031, 488, 9, 34, "Output",ExpressionUUID->"9d67fc86-36c9-43a8-908e-cdf8455cfbe1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34469, 1045, 2033, 60, 115, "Input",ExpressionUUID->"03d46ef1-701c-429f-b13d-fb91f9f5f2e7"],
Cell[36505, 1107, 1081, 33, 34, "Output",ExpressionUUID->"7ae463fb-ce66-45b3-9b70-a7fc62352fda"]
}, Open  ]],
Cell[37601, 1143, 220, 3, 30, "Input",ExpressionUUID->"904857ac-8b99-4242-adbb-3eec2dfb16f3"],
Cell[37824, 1148, 219, 3, 30, "Input",ExpressionUUID->"9b1d7ceb-e8d4-451c-8983-b47f0820c739"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38080, 1156, 196, 3, 54, "Subsection",ExpressionUUID->"48bb1f97-1437-478a-a9e0-60a3ad5a33fc"],
Cell[CellGroupData[{
Cell[38301, 1163, 1078, 29, 52, "Input",ExpressionUUID->"35700b3e-0f16-49e3-baaf-a7fbdb2c990f"],
Cell[39382, 1194, 678, 18, 49, "Output",ExpressionUUID->"824bc9c1-70d5-414d-a714-d628caf41682"]
}, Open  ]],
Cell[40075, 1215, 1168, 35, 52, "Input",ExpressionUUID->"a146d3ab-de7c-416d-8ecc-2da22a98c2cd"],
Cell[41246, 1252, 1847, 56, 73, "Input",ExpressionUUID->"421cb480-adb0-481d-a570-9b2f8f0f064b"],
Cell[CellGroupData[{
Cell[43118, 1312, 380, 9, 30, "Input",ExpressionUUID->"33cfa2ca-acce-4899-af7e-06a7d47c1b23"],
Cell[43501, 1323, 523, 17, 50, "Output",ExpressionUUID->"4d7426a5-987e-470e-98ea-8248ec8b1f1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44061, 1345, 473, 15, 48, "Input",ExpressionUUID->"d890ae3b-e61c-4a88-88e9-587d602c19d9"],
Cell[44537, 1362, 546, 17, 50, "Output",ExpressionUUID->"4984c5fc-a8f8-49e4-8589-e9ccd49b90a8"]
}, Open  ]],
Cell[45098, 1382, 524, 12, 94, "Input",ExpressionUUID->"a80c7cd8-e383-4d68-b088-e9eb6ec03701"],
Cell[45625, 1396, 1781, 55, 73, "Input",ExpressionUUID->"4fb1c3cb-6ed4-4e15-93b6-1894183883e6"],
Cell[47409, 1453, 171, 2, 30, "Input",ExpressionUUID->"072e79f6-1852-41ce-9625-e4b009a5bd9f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47629, 1461, 153, 3, 67, "Section",ExpressionUUID->"6b0c93ba-2b0f-477b-aa80-1fd674efe82d"],
Cell[47785, 1466, 7663, 213, 346, "Input",ExpressionUUID->"0cd328d6-2a5b-4fb5-8871-a910b501e073"],
Cell[55451, 1681, 270, 4, 30, "Input",ExpressionUUID->"b7d8cf62-6f0c-4a51-af3a-f54cd08f2b57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55758, 1690, 173, 3, 67, "Section",ExpressionUUID->"9610fc8b-958c-4608-a8f0-18cffbd8896c"],
Cell[55934, 1695, 1194, 32, 73, "Input",ExpressionUUID->"309c108a-cb06-4f4e-97d7-10cb91f8a652"],
Cell[CellGroupData[{
Cell[57153, 1731, 1457, 37, 94, "Input",ExpressionUUID->"a8e2501e-1a87-4a3c-8fcf-66a9b0b4d435"],
Cell[58613, 1770, 1012, 32, 34, "Output",ExpressionUUID->"1677a019-96d6-48a1-a3ca-16f0f0a07d4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59662, 1807, 1058, 27, 94, "Input",ExpressionUUID->"e99fa36f-e9cc-4b0b-9e20-8bde0e513aa8"],
Cell[60723, 1836, 509, 11, 50, "Output",ExpressionUUID->"13bd0aed-1016-4c0a-8865-63ed43b8ac15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61269, 1852, 2052, 51, 115, "Input",ExpressionUUID->"50eb7e57-0df5-4a1d-88ef-329b2e4e4d2a"],
Cell[63324, 1905, 861, 23, 50, "Output",ExpressionUUID->"a02b2e37-8a75-4d26-95a0-396d3cb1053d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64222, 1933, 2273, 56, 178, "Input",ExpressionUUID->"d98eedf8-2cc9-44c5-a7d3-d0b316adfde4"],
Cell[66498, 1991, 805, 23, 50, "Output",ExpressionUUID->"21a03cde-0b63-4ee0-a5d6-01ea763914b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67340, 2019, 223, 3, 30, "Input",ExpressionUUID->"3c3ba454-36bb-4e6d-b777-7506c68fb607"],
Cell[67566, 2024, 962, 31, 34, "Output",ExpressionUUID->"311b6dcb-6dcf-4144-b571-ca76292a524d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68565, 2060, 860, 17, 73, "Input",ExpressionUUID->"4328c0ca-18c8-46e4-9785-730c7a8f4221"],
Cell[69428, 2079, 8869, 253, 203, "Output",ExpressionUUID->"cb7256f7-9b0f-4040-95bb-8ddabe80def1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78334, 2337, 181, 3, 30, "Input",ExpressionUUID->"8abf78eb-184d-4e0b-8c08-5e36ba943671"],
Cell[78518, 2342, 1219, 37, 89, "Output",ExpressionUUID->"b7594403-a7cf-4365-91de-5b7e7196d833"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79786, 2385, 247, 4, 67, "Section",ExpressionUUID->"693b49f9-5600-4c0a-aa37-80c1666ab78e"],
Cell[CellGroupData[{
Cell[80058, 2393, 174, 3, 54, "Subsection",ExpressionUUID->"34332906-7fbf-47b0-90cb-a392fb741c13"],
Cell[80235, 2398, 632, 18, 30, "Input",ExpressionUUID->"c9c9ef9c-f0c2-4121-9f0b-8b1b3bf6186c"],
Cell[80870, 2418, 1503, 41, 115, "Input",ExpressionUUID->"250e9b8e-e1d0-4019-af39-dfcc38227db4"],
Cell[CellGroupData[{
Cell[82398, 2463, 489, 12, 30, "Input",ExpressionUUID->"a6dd4e7e-43c9-4cc8-8ee9-af39e020173d"],
Cell[82890, 2477, 252, 4, 34, "Output",ExpressionUUID->"027b241e-ddfb-4908-86da-8feac95ef125"]
}, Open  ]],
Cell[83157, 2484, 2525, 72, 94, "Input",ExpressionUUID->"150c19fe-3024-46e2-aa73-f6c9f3829de9"],
Cell[85685, 2558, 652, 15, 52, "Input",ExpressionUUID->"3235937b-b509-4dd5-a503-d8b5e61e220e"],
Cell[86340, 2575, 322, 4, 30, "Input",ExpressionUUID->"24f0e112-6ffd-4e59-907e-31e332ea9e2a"]
}, Open  ]],
Cell[86677, 2582, 195, 3, 54, "Subsection",ExpressionUUID->"871b4b37-e9af-4b22-ac32-0c112c412a7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86909, 2590, 152, 3, 67, "Section",ExpressionUUID->"7ec406f6-4379-4234-9b8f-031daa2e2219"],
Cell[CellGroupData[{
Cell[87086, 2597, 223, 4, 45, "Subsubsection",ExpressionUUID->"d7c1d0e7-59eb-4a95-a291-499cd1a94a84"],
Cell[CellGroupData[{
Cell[87334, 2605, 583, 11, 52, "Input",ExpressionUUID->"3f04d1e6-d515-4ac9-b8b5-7f5e5bf5698a"],
Cell[87920, 2618, 1097, 33, 34, "Output",ExpressionUUID->"2a95fc13-6e78-4775-83ce-87cefe173a01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89054, 2656, 1561, 38, 73, "Input",ExpressionUUID->"3832a264-0b73-447e-af31-25b8cc02c8fb"],
Cell[90618, 2696, 1125, 33, 34, "Output",ExpressionUUID->"14a3985d-6980-43f5-b285-40d4d203607f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91780, 2734, 1924, 55, 94, "Input",ExpressionUUID->"cc075b7d-9d9f-497b-8d35-d75dda1ff96c"],
Cell[93707, 2791, 1153, 34, 34, "Output",ExpressionUUID->"d6e50eb6-2108-4cce-9c7a-2502cea6c267"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94897, 2830, 2095, 62, 115, "Input",ExpressionUUID->"17a06840-29a8-4b90-ada7-8c4a30d16f3f"],
Cell[96995, 2894, 1108, 34, 34, "Output",ExpressionUUID->"294215d5-395f-475b-b43e-228111223608"]
}, Open  ]],
Cell[98118, 2931, 228, 4, 30, "Input",ExpressionUUID->"ce9a8244-8850-4fb6-a636-759a16ae4d18"],
Cell[CellGroupData[{
Cell[98371, 2939, 677, 19, 30, "Input",ExpressionUUID->"b52135bb-6f5d-4fc2-96fc-6935aa6801d8"],
Cell[99051, 2960, 228, 4, 34, "Output",ExpressionUUID->"8614c3f1-d40c-4ce0-8c64-ba00c600d39f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99328, 2970, 158, 3, 54, "Subsection",ExpressionUUID->"6366ba68-6c0c-4297-bc68-ce85fa1a5d40"],
Cell[99489, 2975, 1574, 43, 52, "Input",ExpressionUUID->"730921bf-9f2b-415e-8bb3-99eb10f784fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101100, 3023, 164, 3, 54, "Subsection",ExpressionUUID->"54b9e0da-0fa7-4c8a-89a8-fcb05c0da3ad"],
Cell[CellGroupData[{
Cell[101289, 3030, 2582, 66, 199, "Input",ExpressionUUID->"0857a6db-268b-4536-be33-2ba4a1fd56dc"],
Cell[CellGroupData[{
Cell[103896, 3100, 502, 13, 39, "Print",ExpressionUUID->"0a5245cd-aa0f-46d9-9769-f1555fccb22b"],
Cell[104401, 3115, 551, 16, 39, "Print",ExpressionUUID->"7e646804-e8a2-4a8c-a40c-4cead5765f5d"],
Cell[104955, 3133, 440, 11, 24, "Print",ExpressionUUID->"e85d4d39-5dfc-4b01-a029-0a3b9f24d667"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105468, 3152, 153, 3, 67, "Section",ExpressionUUID->"1f2231ef-508a-4e71-b17a-70de75fd9f50"],
Cell[105624, 3157, 175, 3, 30, "Input",ExpressionUUID->"1aa9c84a-6dc5-4a41-9c35-f7654682c114"],
Cell[105802, 3162, 1409, 39, 94, "Input",ExpressionUUID->"04879cc7-598f-42b3-a48b-ea3af737974f"],
Cell[CellGroupData[{
Cell[107236, 3205, 171, 3, 54, "Subsection",ExpressionUUID->"3997b963-dbf6-48a0-b33e-604bd56950db"],
Cell[CellGroupData[{
Cell[107432, 3212, 1541, 43, 73, "Input",ExpressionUUID->"2f05f8f4-f619-4840-a21e-90677aefd9ca"],
Cell[108976, 3257, 1152, 34, 34, "Output",ExpressionUUID->"49a7b0d1-d24f-467a-b7c3-f205f4f8d588"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110165, 3296, 1860, 53, 94, "Input",ExpressionUUID->"ac060537-57d4-4a84-8cf2-b7add9e3be0b"],
Cell[112028, 3351, 560, 10, 34, "Output",ExpressionUUID->"f52ed775-731f-4f92-bf79-b3e6e4113019"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112625, 3366, 2083, 61, 115, "Input",ExpressionUUID->"b689c927-0fbb-458e-8d98-79be29048ba7"],
Cell[114711, 3429, 1153, 34, 34, "Output",ExpressionUUID->"df3124ef-a249-4341-9bff-6f6771c0a4e2"]
}, Open  ]],
Cell[115879, 3466, 224, 4, 30, "Input",ExpressionUUID->"f558bc53-d963-4482-b564-91ca0466b4de"],
Cell[116106, 3472, 223, 4, 30, "Input",ExpressionUUID->"7dd48178-f884-4f63-bb91-947db9811110"],
Cell[116332, 3478, 177, 3, 30, "Input",ExpressionUUID->"506e82df-6ce2-4af3-8657-b41593b4e4ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116546, 3486, 196, 3, 54, "Subsection",ExpressionUUID->"091af4bf-ba97-45a9-9065-ba5c91d27333"],
Cell[116745, 3491, 1389, 41, 52, "Input",ExpressionUUID->"b1818e8c-1769-4f6e-a532-429142f6ce3e"],
Cell[118137, 3534, 589, 14, 94, "Input",ExpressionUUID->"b8f2c901-daa1-49fb-97ad-bb476d461efa"],
Cell[118729, 3550, 226, 4, 30, "Input",ExpressionUUID->"4c156451-30a7-4321-9da5-686d9945ed62"],
Cell[118958, 3556, 174, 3, 30, "Input",ExpressionUUID->"5a73c534-7807-4715-9d3c-8857e56d34f1"],
Cell[119135, 3561, 175, 3, 30, "Input",ExpressionUUID->"794a7850-2eb4-4323-9a73-5413f5ba3a15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119347, 3569, 164, 3, 54, "Subsection",ExpressionUUID->"b8b997e9-3be8-4eef-826d-cf9e06d43b89"],
Cell[CellGroupData[{
Cell[119536, 3576, 2575, 66, 199, "Input",ExpressionUUID->"078bb3f9-001d-4932-80c3-171eac70cbbe"],
Cell[CellGroupData[{
Cell[122136, 3646, 574, 15, 39, "Print",ExpressionUUID->"ababe14f-2c88-4609-9cea-301b12b1020f"],
Cell[122713, 3663, 789, 22, 39, "Print",ExpressionUUID->"2fc9a803-088f-4bbe-91fc-fe82f03ada4c"],
Cell[123505, 3687, 810, 23, 39, "Print",ExpressionUUID->"1879e8fc-08ca-4faf-b413-9b35edd9090d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124364, 3716, 3636, 98, 241, "Input",ExpressionUUID->"549849c0-b0ba-48a6-9ee9-6b4a368c0e5e"],
Cell[CellGroupData[{
Cell[128025, 3818, 576, 14, 39, "Print",ExpressionUUID->"182f3f2e-4e5b-45ba-9ac2-c5403305bc3c"],
Cell[128604, 3834, 574, 14, 39, "Print",ExpressionUUID->"b58ff2be-9556-4f3f-82e6-de53177e7b6f"],
Cell[129181, 3850, 516, 11, 24, "Print",ExpressionUUID->"6993ff42-d7ad-4659-89b2-a5193b5ca017"]
}, Open  ]]
}, Open  ]],
Cell[129724, 3865, 222, 4, 52, "Input",ExpressionUUID->"19a2d63b-074e-4982-a7ff-7c9e000ed65d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129995, 3875, 153, 3, 67, "Section",ExpressionUUID->"6b941f72-fbe5-4d10-aee0-354381eee19e"],
Cell[130151, 3880, 7304, 201, 325, "Input",ExpressionUUID->"e982d529-bf6c-460a-9655-aec786b41b25"],
Cell[137458, 4083, 223, 4, 30, "Input",ExpressionUUID->"08c73c88-5636-43a0-add3-1c02fb749ebc"],
Cell[CellGroupData[{
Cell[137706, 4091, 164, 3, 54, "Subsection",ExpressionUUID->"105516dd-a3aa-4300-87eb-ab93a0b5e34e"],
Cell[CellGroupData[{
Cell[137895, 4098, 1769, 43, 178, "Input",ExpressionUUID->"b6524814-ab16-40e7-8612-d0165b2e4784"],
Cell[CellGroupData[{
Cell[139689, 4145, 549, 15, 39, "Print",ExpressionUUID->"9f92d13e-d0f2-4201-b1e6-a57d4149a139"],
Cell[140241, 4162, 567, 16, 39, "Print",ExpressionUUID->"67f92211-bf9c-4a3e-ae9d-8f4afe4e91f1"],
Cell[140811, 4180, 566, 16, 39, "Print",ExpressionUUID->"cf144932-6e24-4aee-ac7d-985b907e8e7b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141426, 4202, 2299, 60, 220, "Input",ExpressionUUID->"4d679a41-7ebe-4d61-a01d-bad2a3f8f054"],
Cell[CellGroupData[{
Cell[143750, 4266, 237, 6, 39, "Print",ExpressionUUID->"12e2b12b-2987-4052-a9e0-e51c936eee90"],
Cell[143990, 4274, 214, 5, 24, "Print",ExpressionUUID->"c16ce6db-6232-48de-9507-c24511235964"],
Cell[144207, 4281, 235, 6, 39, "Print",ExpressionUUID->"a6b25e02-56b4-47e7-80a5-c4a836b9946f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

